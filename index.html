<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Documenta√ß√£o GenieACS - An√°lise Completa</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    :root {
      --primary-color: #00ff99;
      --hover-color: #e0e0e0;
      --code-bg: #191919;
      --success-color: #4CAF50;
      --error-color: #f44336;
    }
    
    .copy-btn {
      background: var(--primary-color);
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 2px 8px;
      font-size: 12px;
      cursor: pointer;
      margin-left: 10px;
      transition: all 0.3s;
    }
    .copy-btn:hover {
      background: var(--hover-color);
    }
    .code-container {
      position: relative;
    }
    .code-container pre {
      background: var(--code-bg);
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .code-container .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
    }
    a.external-link {
      color: #06c;
      text-decoration: none;
    }
    a.external-link:hover {
      text-decoration: underline;
    }
    .device-test {
      margin: 15px 0;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 4px;
    }
    .test-success {
      border-left: 4px solid var(--success-color);
    }
    .test-observation {
      border-left: 4px solid #FFA500;
    }
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <h2>Documenta√ß√£o</h2>
      <nav>
        <ul>
          <li><a href="#introducao">Introdu√ß√£o</a></li>
          <li><a href="#ambiente">Ambiente de Testes</a></li>
          <li><a href="#endpoints">Endpoints API</a></li>
          <li><a href="#comportamento-web">Comportamento Web</a></li>
          <li><a href="#comportamento-api">Comportamento API</a></li>
          <li><a href="#analise-dispositivos">An√°lise por Dispositivo</a></li>
          <li><a href="#conclusoes">Conclus√µes</a></li>
        </ul>
      </nav>
    </aside>
    
    <main class="content">
      <section id="introducao">
        <h1>Introdu√ß√£o</h1>
        <p>Esta documenta√ß√£o cobre a API de gerenciamento TR-069 e a an√°lise detalhada do comportamento de diferentes dispositivos CPE com o GenieACS, incluindo testes atualizados e novos equipamentos.</p>
      </section>

      <section id="ambiente">
        <h1>üîß Ambiente de Testes</h1>
        <ul>
          <li><strong>Interface Web:</strong> <a href="http://192.168.2.232:3000/" class="external-link" target="_blank" rel="noopener noreferrer">Porta 3000</a></li>
          <li><strong>API:</strong> Porta 7557</li>
          <li><strong>Configura√ß√£o:</strong> Porta 7547</li>
          <li><strong>Dispositivos testados:</strong> 
            <ul>
              <li>ZTE F660</li>
              <li>Greatek v1 (GT-784WN)</li>
              <li>Greatek v2 (GT-784WNv2)</li>
              <li>Huawei HG8245H</li>
            </ul>
          </li>
        </ul>
      </section>

      <section id="endpoints">
        <h1>üì° Endpoints da API</h1>
        
        <article class="endpoint">
          <h2>POST /devices/&lt;device-id&gt;/tasks?timeout=3000&connection_request</h2>
          <div class="code-container">
            <pre><code id="code1">{
  "name": "reboot"
}</code></pre>
            <button class="copy-btn" aria-label="Copiar c√≥digo" onclick="copyToClipboard('code1')">Copiar</button>
          </div>
          <p><strong>Fun√ß√£o:</strong> Reinicia o equipamento</p>
          <p><strong>Tempo m√©dio de resposta:</strong> 1-3 minutos dependendo do dispositivo</p>
        </article>
        
        <article class="endpoint">
          <h2>GET /devices</h2>
          <p><strong>Corpo:</strong> Nenhum</p>
          <p><strong>Fun√ß√£o:</strong> Lista todos os dispositivos e seus par√¢metros</p>
        </article>
        
        <article class="endpoint">
          <h2>POST /devices/&lt;device-id&gt;/tasks?connection_request</h2>
          <div class="code-container">
            <pre><code id="code2">{
  "name": "getParameterValues",
  "parameterNames": [
    "InternetGatewayDevice"
  ]
}</code></pre>
            <button class="copy-btn" aria-label="Copiar c√≥digo" onclick="copyToClipboard('code2')">Copiar</button>
          </div>
          <p><strong>Fun√ß√£o:</strong> For√ßa a captura dos par√¢metros do dispositivo</p>
          <p><strong>Tempo m√©dio de resposta:</strong> At√© 1 minuto</p>
        </article>
        
        <article class="endpoint">
          <h2>POST /devices/&lt;device-id&gt;/tasks?connection_request</h2>
          <div class="code-container">
            <pre><code id="code3">{
  "name": "setParameterValues",
  "parameterValues": [
    ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSID", "Grealeevit 5G - API", "xsd:string"],
    ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.2.SSID", "Grealeevit 2.4G - API", "xsd:string"],
    ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.PreSharedKey.1.KeyPassphrase", "levit1906", "xsd:string"],
    ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.2.PreSharedKey.1.KeyPassphrase", "levit1906", "xsd:string"]
  ]
}</code></pre>
            <button class="copy-btn" aria-label="Copiar c√≥digo" onclick="copyToClipboard('code3')">Copiar</button>
          </div>
          <p><strong>Fun√ß√£o:</strong> Define o valor de par√¢metros WLAN (formato atualizado)</p>
          <p><strong>Observa√ß√£o:</strong> Usar KeyPassphrase ao inv√©s de PreSharedKey para senhas WiFi</p>
        </article>
      </section>

      <section id="comportamento-web">
        <h1>üåê Comportamento da Interface Web</h1>
        <ul>
          <li>Exibe dispositivos como "online", mas opera√ß√µes frequentemente falham</li>
          <li>Atualiza√ß√£o de par√¢metros pode exigir refresh manual ou nova captura via API</li>
          <li>Performance varia significativamente entre modelos de dispositivos</li>
        </ul>
      </section>

      <section id="comportamento-api">
        <h1>üß™ Comportamento via API</h1>
        <ul>
          <li>Mais confi√°vel que a interface web para execu√ß√£o de comandos</li>
          <li>Tarefas s√£o frequentemente aplicadas apenas ap√≥s reboot</li>
          <li>Tempos de resposta consistentes ap√≥s ajustes na implementa√ß√£o</li>
        </ul>
      </section>

      <section id="analise-dispositivos">
        <h1>üì∂ An√°lise por Dispositivo</h1>
        
        <article class="device">
          <h2>ZTE F660</h2>
          <ul>
            <li><strong>Estabilidade:</strong> Inst√°vel</li>
            <li><strong>Flexibilidade de comandos:</strong> Limitada</li>
            <li><strong>Configura√ß√£o WLAN:</strong>
              <ul>
                <li>WLAN 1: 2.4GHz</li>
                <li>WLAN 5: 5.8GHz</li>
              </ul>
            </li>
            <li><strong>Tempo m√©dio de reboot:</strong> 2-3 minutos</li>
            <li><strong>Atualiza√ß√£o de par√¢metros:</strong> Requer m√∫ltiplas tentativas</li>
          </ul>
        </article>
        
        <article class="device">
          <h2>Greatek v1 (GT-784WN)</h2>
          <ul>
            <li><strong>Estabilidade:</strong> Boa</li>
            <li><strong>Configura√ß√£o WLAN:</strong>
              <ul>
                <li>WLAN 1: 5.8GHz</li>
                <li>WLAN 2: 2.4GHz</li>
              </ul>
            </li>
            <li><strong>Tempo m√©dio de reboot:</strong> 1-2 minutos</li>
            <li><strong>Testes realizados:</strong>
              <ol>
                <li>Altera√ß√£o de SSID e senha via API</li>
                <li>Rein√≠cio via API</li>
                <li>Altera√ß√£o de canal</li>
              </ol>
            </li>
            <li><strong>Resultados:</strong>
              <ul>
                <li>Altera√ß√µes aplicadas corretamente ap√≥s reboot</li>
                <li>Interface web reflete par√¢metros atualizados</li>
                <li>N√£o requer captura adicional de par√¢metros</li>
              </ul>
            </li>
          </ul>
          
          <div class="device-test test-success">
            <strong>Teste Atualizado:</strong> 10 reboots consecutivos com intervalo de 5 minutos - todos conclu√≠dos em 1-2 minutos
          </div>
        </article>
        
        <article class="device">
          <h2>Greatek v2 (GT-784WNv2)</h2>
          <ul>
            <li><strong>Estabilidade:</strong> Regular (melhorou com ajustes)</li>
            <li><strong>Configura√ß√£o WLAN:</strong>
              <ul>
                <li>WLAN 1: 5.8GHz</li>
                <li>WLAN 2: 2.4GHz</li>
              </ul>
            </li>
            <li><strong>Tempo m√©dio de reboot:</strong> ~1 minuto</li>
            <li><strong>Comportamento inicial:</strong>
              <ul>
                <li>Subiu apenas com par√¢metros de f√°brica</li>
                <li>Requer comando expl√≠cito para obter par√¢metros gerais</li>
              </ul>
            </li>
          </ul>
          
          <div class="device-test test-success">
            <strong>Teste 1:</strong> Obten√ß√£o de par√¢metros via API<br>
            <strong>Resultado:</strong> Interface web mostrou todos par√¢metros em at√© 1 minuto
          </div>
          
          <div class="device-test test-observation">
            <strong>Teste 2:</strong> Altera√ß√£o de SSID e senha<br>
            <strong>Observa√ß√£o:</strong> Par√¢metro PreSharedKey ineficaz, KeyPassphrase funcionou<br>
            <strong>Solu√ß√£o:</strong> Usar "InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.PreSharedKey.1.KeyPassphrase"
          </div>
          
          <div class="device-test test-success">
            <strong>Teste 3:</strong> Altera√ß√£o de canal com reboot<br>
            <strong>Resultado:</strong> Conclu√≠do em ~1 minuto, altera√ß√£o aplicada
          </div>
          
          <div class="device-test test-observation">
            <strong>Comportamento Atualizado:</strong> 
            <ul>
              <li>Maioria das mudan√ßas agora aparece na interface web</li>
              <li>Exige captura manual de par√¢metros via API para atualiza√ß√£o completa</li>
              <li>Fila de tasks est√° funcionando corretamente com reboots precisos</li>
            </ul>
          </div>
        </article>
        
        <article class="device">
          <h2>Huawei HG8245H</h2>
          <ul>
            <li><strong>Estabilidade:</strong> Excelente</li>
            <li><strong>Configura√ß√£o WLAN:</strong>
              <ul>
                <li>WLAN 1: 2.4GHz</li>
                <li>WLAN 2: 5.8GHz</li>
              </ul>
            </li>
            <li><strong>Tempo m√©dio de reboot:</strong> 1 minuto</li>
            <li><strong>Testes realizados:</strong>
              <ol>
                <li>Altera√ß√£o completa de configura√ß√£o WLAN</li>
                <li>M√∫ltiplos reboots consecutivos</li>
                <li>Atualiza√ß√£o de firmware remota</li>
              </ol>
            </li>
            <li><strong>Resultados:</strong>
              <ul>
                <li>Todas as altera√ß√µes aplicadas imediatamente</li>
                <li>Interface web atualiza em tempo real</li>
                <li>N√£o requer captura adicional de par√¢metros</li>
              </ul>
            </li>
          </ul>
        </article>
      </section>

      <section id="conclusoes">
        <h1>üìå Conclus√µes Gerais</h1>
        <ul>
          <li><strong>Greatek v1:</strong> Continua sendo o mais compat√≠vel, com comportamento consistente</li>
          <li><strong>Greatek v2:</strong> Melhorou significativamente ap√≥s ajustes, agora com fila de tasks funcional</li>
          <li><strong>Huawei HG8245H:</strong> Apresentou o melhor desempenho geral</li>
          <li><strong>ZTE F660:</strong> Ainda o menos confi√°vel, com tempos de resposta mais longos</li>
          <li><strong>Padr√£o de comandos:</strong> KeyPassphrase √© o par√¢metro correto para senhas WiFi na maioria dos dispositivos</li>
          <li><strong>Tempos de resposta:</strong> Todos os dispositivos agora respeitam tempos m√°ximos de 3 minutos para opera√ß√µes cr√≠ticas</li>
        </ul>
        
        <h2>Recomenda√ß√µes</h2>
        <ol>
          <li>Priorizar uso da API sobre a interface web</li>
          <li>Implementar timeout m√≠nimo de 3 minutos para opera√ß√µes</li>
          <li>Usar KeyPassphrase ao inv√©s de PreSharedKey para senhas WiFi</li>
          <li>Considerar Huawei HG8245H como dispositivo de refer√™ncia para novos testes</li>
        </ol>
      </section>
    </main>
  </div>

  <script>
    async function copyToClipboard(id) {
      const codeElement = document.getElementById(id);
      const btn = event.target;
      
      try {
        await navigator.clipboard.writeText(codeElement.textContent.trim());
        btn.textContent = 'Copiado!';
        btn.style.backgroundColor = var(--success-color);
        setTimeout(() => {
          btn.textContent = 'Copiar';
          btn.style.backgroundColor = '';
        }, 2000);
      } catch (err) {
        console.error('Falha ao copiar texto: ', err);
        btn.textContent = 'Erro!';
        btn.style.backgroundColor = var(--error-color);
        setTimeout(() => {
          btn.textContent = 'Copiar';
          btn.style.backgroundColor = '';
        }, 2000);
        
        // Fallback para navegadores antigos
        const range = document.createRange();
        range.selectNode(codeElement);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();
      }
    }
  </script>
</body>
</html>
