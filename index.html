<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Documentação GenieACS - Análise Completa</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .copy-btn {
      background: #00ff99;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 2px 8px;
      font-size: 12px;
      cursor: pointer;
      margin-left: 10px;
      transition: all 0.3s;
    }
    .copy-btn:hover {
      background: #e0e0e0;
    }
    .code-container {
      position: relative;
    }
    .code-container pre {
      background: #191919;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .code-container .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
    }
    a.external-link {
      color: #06c;
      text-decoration: none;
    }
    a.external-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

    <h1>Documentação de Testes – API GenieACS & Comportamento de Dispositivos CPE (TR-069)</h1>

    <h2>Introdução</h2>
    <p>Esta documentação registra os testes realizados com o <strong>GenieACS</strong> utilizando sua API TR-069 para controle remoto e automação de dispositivos CPE (Customer Premises Equipment), focando em:</p>
    <ul>
        <li>Captura e alteração de parâmetros (SSID, senha, canal, etc.)</li>
        <li>Comportamento da interface web</li>
        <li>Estabilidade e resposta dos dispositivos testados</li>
    </ul>

    <h2>Ambiente de Testes</h2>
    <ul>
        <li><strong>Interface Web</strong>: Porta 3000</li>
        <li><strong>API</strong>: Porta 7557</li>
        <li><strong>TR-069</strong>: Porta 7547</li>
        <li><strong>Dispositivos testados</strong>:
            <ul>
                <li>ZTE ONT</li>
                <li>Greatek v1</li>
                <li>Greatek v2</li>
                <li>Intelbras RX1500</li>
            </ul>
        </li>
    </ul>

    <h2>Endpoints da API</h2>

    <h3>Reiniciar dispositivo</h3>
    <p><strong>POST</strong> /devices/&lt;device-id&gt;/tasks?timeout=3000&connection_request</p>
    <pre>{ "name": "reboot" }</pre>

    <h3>Listar dispositivos</h3>
    <p><strong>GET</strong> /devices</p>

    <h3>Capturar parâmetros do dispositivo</h3>
    <p><strong>POST</strong> /devices/&lt;device-id&gt;/tasks?connection_request</p>
    <pre>
    {
        "name": "getParameterValues",
        "parameterNames": ["InternetGatewayDevice"]
    }
    </pre>

    <h3>Definir parâmetros do dispositivo</h3>
    <p><strong>POST</strong> /devices/&lt;device-id&gt;/tasks?connection_request</p>
    <pre>
    {
        "name": "setParameterValues",
        "parameterValues": [
            ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSID", "SSID 5G", "xsd:string"],
            ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.2.SSID", "SSID 2.4G", "xsd:string"],
            ["InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.PreSharedKey.1.KeyPassphrase", "senha123", "xsd:string"]
        ]
    }
    </pre>

    <h3>Listar tarefas</h3>
    <p><strong>GET</strong> /tasks</p>

    <h3>Remover tarefa</h3>
    <p><strong>DELETE</strong> /tasks/&lt;task-id&gt;</p>

    <h2>Comportamento da Interface Web</h2>
    <ul>
        <li>Mostra dispositivos como "online" mesmo sem resposta real.</li>
        <li>Comandos geralmente falham para ZTE e Greatek v1 na interface.</li>
        <li>Necessidade frequente de reboot ou uso de API para refletir mudanças.</li>
        <li><strong>Intelbras</strong> mostrou diferença importante: exibe <strong>senha do Wi-Fi</strong> no campo <code>KeyPassphrase</code>, ao contrário dos demais.</li>
    </ul>

    <h2>Análise por Dispositivo</h2>

    <h3>ZTE ONT</h3>
    <ul>
        <li><strong>Parâmetros WLAN</strong>: WLAN 1: 2.4GHz, WLAN 5: 5.8GHz</li>
        <li><strong>Resultados</strong>: Instável, erros frequentes na interface e API, pouca compatibilidade com comandos de alteração</li>
        <li><strong>Conclusão</strong>: Pouco funcional com GenieACS</li>
    </ul>

    <h3>Greatek v1</h3>
    <ul>
        <li><strong>Parâmetros WLAN</strong>: WLAN 1: 2.4GHz, WLAN 2: 5.8GHz</li>
        <li><strong>Resultados</strong>: SSID e senha alterados com sucesso via API, Reboot necessário para aplicar, Interface web não atualiza sem nova captura</li>
        <li><strong>Conclusão</strong>: Alta compatibilidade, requer apenas reboot</li>
    </ul>

    <h3>Greatek v2</h3>
    <ul>
        <li><strong>Parâmetros WLAN</strong>: WLAN 1: 5.8GHz, WLAN 2: 2.4GHz</li>
        <li><strong>Resultados</strong>: Subiu com valores de fábrica (SSID/senha), sem parâmetros gerais, Captura de parâmetros via API funcionou (status 202), atualização na interface em 1min</li>
        <li><strong>Conclusão</strong>: Agora funcional e previsível, mas depende de captures manuais</li>
    </ul>

    <h3>Intelbras RX1500</h3>
    <ul>
        <li><strong>Parâmetros WLAN</strong>: WLAN 1: 2.4GHz, WLAN 2: 5.8GHz</li>
        <li><strong>Diferenciais observados</strong>: Mostra valor real da senha Wi-Fi na interface (<code>KeyPassphrase</code>), Ao alterar SSID/senha pela interface web ou API, recebe status <strong>200 (OK)</strong> e aplica na hora, sem reboot, Interface web permite modificar todos os parâmetros writables, Reboot via API funciona corretamente (delay de ~1min)</li>
        <li><strong>Canal e AutoChannel</strong>: Permite alteração de canal, AutoChannel <code>true</code> é sobrescrito ao definir canal fixo (testado com canal 3)</li>
        <li><strong>Conclusão</strong>: Melhor desempenho geral e integração nativa com GenieACS, Responde e aplica alterações sem reinício</li>
    </ul>

    <h2>Observações Gerais</h2>
    <ul>
        <li><strong>Canal WLAN e AutoChannel</strong>: Todos os dispositivos (exceto ZTE) aceitam alteração de canal e opção de autochannel (boolean).</li>
        <li><strong>KeyPassphrase vs PreSharedKey</strong>: Nos Greatek, apenas <code>KeyPassphrase</code> surte efeito. Intelbras usa <code>KeyPassphrase</code> e exibe o valor diretamente.</li>
    </ul>

    <h2>Conclusões Finais</h2>

    <table>
        <thead>
            <tr>
                <th>Dispositivo</th>
                <th>Interface Web</th>
                <th>API Compatível</th>
                <th>Reboot Necessário</th>
                <th>Tempo Médio Reboot</th>
                <th>Reflete Atualizações</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ZTE ONT</td>
                <td>❌</td>
                <td>❌</td>
                <td>Sim (inconsistente)</td>
                <td>—</td>
                <td>❌</td>
            </tr>
            <tr>
                <td>Greatek v1</td>
                <td>⚠️ (limitada)</td>
                <td>✅</td>
                <td>Sim</td>
                <td>3 minutos</td>
                <td>✅ (após reboot)</td>
            </tr>
            <tr>
                <td>Greatek v2</td>
                <td>⚠️ (limitada)</td>
                <td>✅</td>
                <td>Sim</td>
                <td>1 minuto</td>
                <td>⚠️ (exige captura)</td>
            </tr>
            <tr>
                <td>Intelbras RX1500</td>
                <td>✅</td>
                <td>✅</td>
                <td>Não</td>
                <td>—</td>
                <td>✅</td>
            </tr>
        </tbody>
    </table>

</body>
</html>

